{{define "nexthome"}}
<!DOCTYPE html>
<html lang="en">
{{ template "html-head" "Decred Block Explorer by dcrdata.org"}}

      <script src="/js/jquery.js"></script>
      <script>
        function cleanUp() {
            $('.block-votes').each(function() {
                var blockVotes = $(this);
                var votes = blockVotes.attr('data-value');
                for (var i = 0; i < 5 - votes; i++) {
                    blockVotes.append('<span></span>');
                }
            })

            $('.block-tickets').each(function() {
                var blockTicketsAndRevs = $(this);
                var count = blockTicketsAndRevs.children().length;
                for (var i = 0; i < 20 - count; i++) {
                    blockTicketsAndRevs.append('<span></span>');
                }
            })

            $('.block-ticket').each(function() {
                var blockTicket = $(this);
                var opacity = (blockTicket.attr('data-input') + blockTicket.attr('data-output')) / 10;
                blockTicket.css('opacity', opacity);
            })

            $('.block-rev').each(function() {
                var blockRev = $(this);
                var opacity = (blockRev.attr('data-input') + blockRev.attr('data-output')) / 10;
                blockRev.css('opacity', opacity);
            })

            $('.block-tx').each(function() {
                var blockTx = $(this);
                var opacity = (blockTx.attr('data-input') + blockTx.attr('data-output')) / 10;
                blockTx.css('opacity', opacity);

                var amount = blockTx.attr('data-size');
                blockTx.css('flex-grow', amount);
            })
        }
      </script>
      <script>
      // For dyanamic transactions, tickets, votes, revoke bar display

        var ticketbar = "<span class='bar-ticket'>&nbsp;</span>";
        var votesbar = "<span class='bar-votes'>&nbsp;</span>";
        var novotesbar = "<span class='no-bar-votes'>&nbsp;</span>";
        var revokebar = "<span class='bar-revoke'>&nbsp;</span>";
        var transactionsbar = "<span class='bar-transactions'>&nbsp;</span>";
        var output = ""; // generic starting output for render area

        /*
        * Renders a single bar or more
        * gets quantity of bars and height id.
        * height is used for area of output
        */
        function renderTransactionsBar(quantity, height) {
          output = "";
          var i;
          for (i = 0; i < quantity; i++) {
            output += transactionsbar;
            console.log("hit");
          }

          $("#transactions-area-"+height).html(output);
        }

        function renderTickets(quantity, height) {
          output = "";
          var i;
          for (i = 0; i < quantity; i++) {
            output += ticketbar;
          }

          $("#tickets-area-"+height).html(output);
        }

        function renderVotes(quantity,height) {
          output = "";
          var i;
          for (i = 0; i < quantity; i++) {
            output += votesbar;
          }

          if (quantity == 0) {
            output = novotesbar;
          }

          $("#votes-area-"+height).html(output);
        }

        function renderRevocations(quantity, height) {
          output = "";
          var i;
          for (i = 0; i < quantity; i++) {
            output += revokebar;
            console.log("hit");
          }

          $("#revoke-area-"+height).html(output);
        }
      </script>
<body>
    {{ template "navbar" . }}
    <div id="mainContainer" class="container" data-controller="main">
        <div class="row">
            <div class="col-lg-6 networkStatsWrapper font-weight-bold">
                <a class="no-underline" href="/statistics">
                    <h3 class="title font-weight-bold" >{{.NetName}} Network Satatistics</h3>
                </a>
                {{with .Info}}
                <div class="statCard general">
                    <div class="row">
                        <div class="col-12">
                            <span><img src="/images/general.png" alt="general"><p class="statcard-title">General</p></span>
                        </div>
                        <div class="col-sm-4">
                            <div class="heading">Available Supply (of 21 mil)</div>
                            <div id="coin-supply" class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="coin-supply">
                                    {{template "decimalParts" (float64AsDecimalParts (toFloat64Amount .CoinSupply) 0 true)}}
                                </span>
                                <span class="pl-1 unit lh15rem">DCR</span>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="heading">Dev Reward</div>
                            <div class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="bsubsidy-dev">
                                    {{template "decimalParts" (float64AsDecimalParts (toFloat64Amount .NBlockSubsidy.Dev) 8 true 2)}}
                                </span>
                                <span class="pl-1 unit lh15rem"> DCR</span>
                            </div>
                        </div>
                        {{if .DevFund}}
                        <div class="col-sm-4">
                            <div class="heading"><a href="/address/{{.DevAddress}}">Project Fund</a></div>
                            <div class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="dev-fund">
                                    {{template "decimalParts" (float64AsDecimalParts (toFloat64Amount .DevFund) 0 true)}}
                                </span>
                                <span class="pl-1 unit lh15rem"> DCR</span>
                            </div>
                        </div>
                        {{end}}
                    </div>
                </div>

                <div class="statCard general">
                    <div class="row">
                        <div class="col-12">
                            <span><img src="/images/staking.png" alt="staking"><p class="statcard-title">Staking</p></span>
                        </div>
                        <div class="col-sm-4">
                            <div class="heading">Total Locked DCR</div>
                            <div class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="pool-value">
                                    {{template "decimalParts" (float64AsDecimalParts .PoolInfo.Value 0 true)}}
                                </span>
                                <span class="pl-1 unit lh15rem">DCR</span>
                            </div>
                            <div class="subdata">
                                <span class="count" id="pool-info-percentage">({{printf "%.2f" .PoolInfo.Percentage}} % of total supply)</span>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="heading">PoS Reward</div>
                            <div class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="bsubsidy-pos">
                                    {{template "decimalParts" (float64AsDecimalParts (toFloat64Amount (divide .NBlockSubsidy.PoS 5)) 8 true 2)}}
                                </span>
                                <span class="pl-1 unit lh15rem" style="font-size:13px;">DCR/vote</span>
                            </div>
                            <div class="subdata">
                                <span id="ticket-reward" class="count">({{template "fmtPercentage" .TicketReward}} per ~{{.RewardPeriod}})</span>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="heading">
                                <a class="no-underline" href="/charts#ticket-price">Ticket Price</a>
                            </div>
                            <div class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="ticket-price">{{template "decimalParts" (float64AsDecimalParts .StakeDiff 8 false 2)}}</span>
                                <span class="pl-1 unit lh15rem">DCR</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="statCard general">
                    <div class="row">
                        <div class="col-12">
                            <span><img src="/images/mining.png" alt="mining"><p class="statcard-title">Mining</p></span>
                        </div>
                        <div class="col-sm-4">
                            <div class="heading">
                                <a class="no-underline" href="/charts#pow-difficulty">Difficulty</a>
                            </div>
                            <div class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="diff">{{template "decimalParts" (float64AsDecimalParts (divideFloat .Difficulty 1000000.0) 0 true)}}</span>
                                <span class="pl-1 unit lh15rem">Mil</span>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="heading">PoW Reward</div>
                            <div class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="bsubsidy-pow">{{template "decimalParts" (float64AsDecimalParts (toFloat64Amount .NBlockSubsidy.PoW) 8 true 2)}}</span>
                                <span class="pl-1 unit lh15rem">DCR</span>
                            </div>
                        </div>
                        <div class="col-sm-4">
                            <div class="heading">Hashrate</div>
                            <div class="data mono lh1rem fs14-decimal count fs24 p03rem0">
                                <span id="hashrate">{{template "decimalParts" (float64AsDecimalParts .HashRate 8 true 2)}}<span>
                                <span class="pl-1 unit lh15rem">Ph/s</span>
                            </div>
                            <div class="subdata">
                                <span id="hashrate-subdata" class="count">({{template "fmtPercentage" .HashRateChange}} in 24h)</span>
                            </div>
                        </div>
                    </div>
                </div>
                {{end}}

            </div>

            <div class="col-lg-6 decBlockchainWrapper">
                <a class="no-underline" href="/blocks">
                    <h3 class="title font-weight-bold">Decred Blockchain</h3><br />
                    <a href="#">Switch view</a>
                </a>
                <div class="row">
                    {{with .Mempool}}
                    <div id="mempool-info" class="col-lg-6 col-md-4 col-sm-6 decredblockWrap">
                        <div class="decredblock">
                            <div class="info-block">
                                <span class="color-code">Mempool</span>
                                <div class="expanded-block">
                                    <div class="row">
                                        <div class="col-12" style="margin-left:6%;">
                                            <img src="/images/amount.png" alt="amount" style="margin-right:3%;">
                                            <div class="data mono lh1rem fs14-decimal fs24">
                                                <span id="mempool-total-sent">
                                                    {{template "decimalParts" (float64AsDecimalParts .TotalOut 2 false 2)}}
                                                </span>
                                                <span class="pl-1 unit lh15rem"> DCR</span>
                                            </div>
                                            <div id="mempool-tx-count" class="subdata">sent in {{.NumAll}} transactions</div>
                                        </div>
                                        <div class="col-5" style="margin-left:6%;">
                                            <img src="/images/votes.png" alt="votes" style="margin: 10% 10%;">
                                            <div class="data">
                                                <p id="mempool-votes" class="count">{{.NumVotes}}</p>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <img src="/images/staking.png" alt="tickets" style="margin: 10% 10%;">
                                            <div class="data">
                                                <p id="mempool-tickets" class="count">{{.NumTickets}}</p>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <button><a class="no-underline" href="/mempool">Show Mempool</a></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="block-rows">
                                <div class="block-rewards">
                                    <span class="pow"></span>
                                    <span class="pos"></span>
                                    <span class="fund"></span>
                                    <span class="fees"></span>
                                </div>
                                <div class="block-votes">
                                </div>
                                <div class="block-tickets">
                                    {{range .Tickets}}
                                    <span class="block-ticket" data-size="{{.TotalOut}}"></span>
                                    {{end}}
                                    {{range .Revocations}}
                                    <span class="block-rev" data-size="{{.TotalOut}}"></span>
                                    {{end}}
                                </div>
                                <div class="block-transactions">
                                    {{range .Transactions}}
                                    <span class="block-tx" data-size="{{.TotalOut}}"></span>
                                    {{end}}
                                </div>
                            </div>
                        </div>
                    </div>
                    {{end}}

                    {{range .Blocks}}
                    <div class="block-info col-lg-6 col-md-4 col-sm-6 decredblockWrap">
                        <div class="decredblock">
                            <div class="info-block">
                                <span id="block-height" class="color-code">{{.Height}}</span>
                                <span class="timespan">
                                    <span id="block-age" data-target="main.age" data-age="{{.BlockTime}}"></span>
                                    <span style="margin-left:.2rem;"> ago</span>
                                </span>
                                <div class="expanded-block">
                                    <div class="row">
                                        <div class="col-12" style="margin-left:6%;">
                                            <img src="/images/amount.png" alt="amount">
                                            <div class="data mono lh1rem fs14-decimal fs24">
                                                <span id="total-sent">
                                                    {{template "decimalParts" (float64AsDecimalParts .TotalSent 2 false 2)}}
                                                </span>
                                                <span class="pl-1 unit lh15rem"> DCR</span>
                                            </div>
                                            <div id="tx-count" class="subdata">sent in {{.AllTxs}} transactions</div>
                                        </div>
                                        <div class="col-5" style="margin-left:6%;">
                                            <img src="/images/votes.png" alt="votes" style="margin: 10% 10%;">
                                            <div class="data">
                                                <p id="votes" class="count">{{.Voters}}</p>
                                            </div>
                                        </div>
                                        <div class="col-6">
                                            <img src="/images/staking.png" alt="tickets" style="margin: 10% 10%;">
                                            <div class="data">
                                                <p id="tickets" class="count">{{.FreshStake}}</p>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                           <button><a id="show-block" class="text-center no-underline" href="/block/{{.Height}}">Show Block</a></button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="block-rows">
                                <div class="block-rewards">
                                    <span class="pow"></span>
                                    <span class="pos"></span>
                                    <span class="fund"></span>
                                    <span class="fees"></span>
                                </div>
                                <div class="block-votes">
                                    {{range .Votes}}
                                    <span style="background-color: {{if .VoteInfo.Validation.Validity}}#6D92DB{{else}}#FF0000{{end}}"></span>
                                    {{end}}
                                </div>
                                <div class="block-tickets">
                                    {{range .Tickets}}
                                    <span class="block-ticket" data-size="{{.Total}}"></span>
                                    {{end}}
                                    {{range .Revs}}
                                    <span class="block-rev" data-size="{{.Total}}"></span>
                                    {{end}}
                                </div>
                                <div class="block-transactions">
                                    {{range .Tx}}
                                    <span class="block-tx" data-size="{{.Total}}"></span>
                                    {{end}}
                                </div>
                            </div>
                        </div>
                    </div>
                    {{end}}
                    <script>cleanUp();</script>
  		        </div>
                <a class="no-underline" href="/blocks"><div class="showmore"><p>View BlockChain History</p></div></a>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function(){
            var count = 0;
            $(".decBlockchainWrapper .decredblockWrap").click(function(){
                $(this).toggleClass("expanded");
                count++;

                if (count > 1) {
                    $(".decBlockchainWrapper .decredblockWrap").removeClass("expanded");
                    count = 0;
                }
            });

            $(".decredblockWrap").click(function() {
                if ($( ".decredblockWrap" ).hasClass( "expanded" )) {
                    $( ".decredblockWrap" ).siblings().addClass("fade");
                } else {
                    $( ".decredblockWrap" ).siblings().removeClass("fade");
                }
            });
        })
    </script>

    {{ template "footer" . }}
</body>
</html>
{{end}}
